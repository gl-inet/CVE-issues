**Description**

vulnerability in the webDav file server. The vulnerable process spawns on boot, and when visiting the web interface at http://IP:80/#/nasview. If the primary webDav server isn’t running, the vulnerable process eventually terminates. The vulnerability can be avoided if webDav is not turned on, and the router is disconnected from the internet during reboots.webDav is an extension to the HTTP protocol that allows for a web server to work as anetwork access storage(NAS) device. The Flint router uses a custom implementation that relies heavily on system calls to function. It uses four binaries gl_nas_sys, gl_nas_client,gl_nas_diskmanager, and gl_nas_copy to complete the feature. The vulnerability is located ingl_nas_sys, and the vulnerable function is located at virtual address 0x0003b948. This function is responsible for authentication.The authentication function is vulnerable to command injection. To compute the password hash, the device builds a command that invokes openssl with the user provided password. If our password contains shell meta characters it’s possible to change the way the command executes. This allows an attacker to run arbitrary shell commands as the root user.

**Affected Product

glinet AX1800

**Exploit**

This vulnerability is exploitable if the user has enabled the webDav file server feature, or if the attacker connects to the device after a recent reboot. The following curl command will exploit the vulnerability.curl -k -v -H 'Token: @#%&&***123456' -H "Content-Type:application/json" -X POST -d'{"name":"root","pwd":"a\n\";reboot\""}' https://192.168.8.1:6000/GL_NAS_USER_LOGINThis command executes the reboot command on the device.

**Impact**

Attackers that successfully exploit this vulnerability gain complete control of the router.

**Discovery**

This vulnerability was discovered using static reverse engineering techniques to verify the legitimacy of a related vulnerability report.
